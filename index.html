<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>WunderTools by wunderkraut</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">WunderTools</h1>
      <h2 class="project-tagline">Project reference setup that gets you started in no time</h2>
      <a href="https://github.com/wunderkraut/WunderTools" class="btn">View on GitHub</a>
    </section>

    <section class="main-content">
      <h1>
<a id="project-reference-setup-with-ansible--vagrant" class="anchor" href="#project-reference-setup-with-ansible--vagrant" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Project reference setup with ansible &amp; vagrant</h1>

<p><a href="https://travis-ci.org/wunderkraut/WunderMachina"><img src="https://travis-ci.org/wunderkraut/WunderMachina.svg?branch=centos7" alt="Build Status"></a></p>

<h2>
<a id="setup" class="anchor" href="#setup" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Setup</h2>

<p>You can setup the IP address and the url of your vagrant machine on the
Vagrantfile.</p>

<p>Edit the variables.yml file to setup the URL and dir for the docs of your project.</p>

<p>Remember to add also the entries in your hosts file for both the drupal install and
the docs.</p>

<p>Requirements:</p>

<ul>
<li>Vagrant 1.5.x</li>
<li>
<a href="https://github.com/fgrehm/vagrant-cachier">https://github.com/fgrehm/vagrant-cachier</a>
( $ vagrant plugin install vagrant-cachier )</li>
<li>Ansible in your host machine. For OS X:
brew install ansible</li>
</ul>

<h2>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h2>

<p>Start by running:</p>

<p>$ vagrant up</p>

<p>This will do the following:</p>

<ul>
<li>clone the latest WunderMachina ansible/vagrant setup (or the version specified in conf/project.yml)</li>
<li>Bring up &amp; provision the virtual machine (if needed)</li>
<li>Build the drupal site under drupal/current (not yet actually)</li>
</ul>

<p>After finishing provisioning (first time is always slow) and building the site
you need to install the Drupal site in <a href="http://x.x.x.x:8080/install.php">http://x.x.x.x:8080/install.php</a>
(Note: on rare occasion php-fpm/varnish/e.g. requires to be restarted before
starting to work. You can do this by issuing the following command:</p>

<p>$ vagrant  ssh -c "sudo service php-fpm restart"
  $ vagrant  ssh -c "sudo service varnish restart"</p>

<p>All Drupal related configurations are under drupal/conf</p>

<p>Drush is usable without ssh access with the drush.sh script e.g:</p>

<p>$ ./drush.sh cc all</p>

<p>To open up ssh access to the virtual machine:</p>

<p>$ vagrant ssh</p>

<hr>

<p>Useful things</p>

<p>At the moment IP is configured in
  Vagrantfile
    variable INSTANCE_IP</p>

<p>Varnish responds to
  <a href="http://x.x.x.x/">http://x.x.x.x/</a></p>

<p>Nginx responds to
  <a href="http://x.x.x.x:8080/">http://x.x.x.x:8080/</a></p>

<p>Solr responds to
  <a href="http://x.x.x.x:8983/solr">http://x.x.x.x:8983/solr</a></p>

<p>MailHOG responds to
  <a href="http://x.x.x.x:8025">http://x.x.x.x:8025</a></p>

<p>Docs are in
        <a href="http://x.x.x.x:8080/index.html">http://x.x.x.x:8080/index.html</a>
        You can setup the dir where the docs are taken from and their URL from the
        variables.yml file.</p>

<pre><code>    #Docs
    docs:
      hostname : 'docs.local.ansibleref.com'
      dir : '/vagrant/docs'
</code></pre>

<h2>
<a id="vagrant--ansible-configuration" class="anchor" href="#vagrant--ansible-configuration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Vagrant + Ansible configuration</h2>

<p>Vagrant is using Ansible provision stored under the ansible subdirectory.
The inventory file (which stores the hosts and their IP's) is located under
ansible/inventory. Host specific configurations for Vagrant are stored in
ansible/vagrant.yml and the playbooks are under ansible/playbook directory.
Variable overrides are defined in ansible/variables.yml.</p>

<p>You should only bother with the following:</p>

<p>Vagrant box setup
    conf/vagrant.yml</p>

<p>What components do you want to install?
    conf/vagrant.yml</p>

<p>And how are those set up?
    conf/variables.yml</p>

<p>You can also fix your vagrant/ansible base setup to certain branch/revision
    conf/project.yml
  There you can also do the same for build.sh</p>

<h2>
<a id="debugging-tools" class="anchor" href="#debugging-tools" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Debugging tools</h2>

<p>XDebug tools are installed via the devtools role. Everything should work out
of the box for PHPStorm. PHP script e.g. drush debugging should also work.</p>

<p>Example sublime text project configuration (via Project-&gt;Edit Project):</p>

<pre><code>{
   "folders":
   [
     {
       "follow_symlinks": true,
       "path": "/path/to/ansibleref"
     }
   ],

   "settings":
   {
     "xdebug": {
          "path_mapping": {
                "/vagrant" : "/path/to/ansibleref"
             }
        }
      }
}
</code></pre>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/wunderkraut/WunderTools">WunderTools</a> is maintained by <a href="https://github.com/wunderkraut">wunderkraut</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
